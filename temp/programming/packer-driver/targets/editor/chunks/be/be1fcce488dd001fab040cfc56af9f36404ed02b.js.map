{"version":3,"sources":["file:///D:/Desktop/cocosProject/SlotBar/assets/slotBar/scripts/views/Login/LoginView.ts"],"names":["_decorator","Button","Component","director","EditBox","ApiService","EventBus","loginViewEventTypes","tipTextEventTypes","ccclass","property","LoginView","onEnable","loginButton","node","on","onLoginButtonClickSpin","registerButton","onRegisterButtonClickSpin","onDisable","off","username","accountInput","string","trim","password","passwordInput","console","warn","tipTextEventBus","emit","ShowTipText","text","result","login","log","message","success","loadScene","err","error","loginViewEventBus","OpenRegisterView"],"mappings":"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","sourcesContent":["import {_decorator, Button, Component, director, EditBox} from 'cc';\r\nimport {ApiService} from \"db://assets/slotBar/scripts/services/ApiService\";\r\nimport EventBus from \"db://assets/slotBar/scripts/eventSystem/EventCenter\";\r\nimport {\r\n    loginViewEventTypes,\r\n    soltEventTypes,\r\n    tipTextEventTypes\r\n} from \"db://assets/slotBar/scripts/eventSystem/EventTypes\";\r\n\r\nconst {ccclass, property} = _decorator;\r\n\r\n@ccclass('LoginView')\r\nexport class LoginView extends Component {\r\n\r\n    @property(EditBox)\r\n    accountInput: EditBox = null;\r\n\r\n    @property(EditBox)\r\n    passwordInput: EditBox = null;\r\n\r\n    @property(Button)\r\n    loginButton: Button = null;\r\n\r\n    @property(Button)\r\n    registerButton: Button = null;\r\n\r\n    onEnable() {\r\n        this.loginButton.node.on('click', this.onLoginButtonClickSpin, this);\r\n        this.registerButton.node.on('click', this.onRegisterButtonClickSpin, this);\r\n    }\r\n\r\n    onDisable() {\r\n        this.loginButton.node.off('click', this.onLoginButtonClickSpin, this);\r\n        this.registerButton.node.off('click', this.onRegisterButtonClickSpin, this);\r\n    }\r\n\r\n    async onLoginButtonClickSpin() {\r\n        const username = this.accountInput.string.trim();\r\n        const password = this.passwordInput.string.trim();\r\n\r\n        if (!username || !password) {\r\n            console.warn(\"請輸入帳號密碼\");\r\n            EventBus.tipTextEventBus.emit(tipTextEventTypes.ShowTipText, { text: '請輸入帳號密碼' });\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const result = await ApiService.login(username, password);\r\n            console.log(result);\r\n            console.log(result.message);\r\n            if (result.success) {\r\n                console.log(\"✅ 登入成功！\");\r\n                EventBus.tipTextEventBus.emit(tipTextEventTypes.ShowTipText, {text: '✅ 登入成功！'});\r\n                director.loadScene(\"SlotScene\");\r\n            } else {\r\n                console.warn(\"❌ 登入失敗：\", result.message);\r\n                EventBus.tipTextEventBus.emit(tipTextEventTypes.ShowTipText, {text: result.message || '❌ 登入失敗，請稍後再試'});\r\n            }\r\n        } catch (err) {\r\n            console.error(\"❌ 登入失敗：\", err);\r\n        }\r\n    }\r\n\r\n    onRegisterButtonClickSpin() {\r\n        EventBus.loginViewEventBus.emit(loginViewEventTypes.OpenRegisterView)\r\n    }\r\n}\r\n\r\n\r\n"]}