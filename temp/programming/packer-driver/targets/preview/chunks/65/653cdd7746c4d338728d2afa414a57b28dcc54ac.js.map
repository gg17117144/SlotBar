{"version":3,"sources":["file:///D:/Desktop/cocosProject/SlotBar/assets/slotBar/scripts/views/Login/RegisterView.ts"],"names":["_decorator","Button","Component","EditBox","ApiService","EventBus","loginViewEventTypes","tipTextEventTypes","ccclass","property","RegisterView","onEnable","backLoginButton","node","on","onLoginButtonClickSpin","registerButton","onRegisterButtonClickSpin","onDisable","off","loginViewEventBus","emit","OpenLoginView","username","accountInput","string","trim","password","passwordInput","email","emailInput","console","log","tipTextEventBus","ShowTipText","text","warn","result","register","success","message","err","error"],"mappings":"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","sourcesContent":["import {_decorator, Button, Component, EditBox, Node} from 'cc';\r\nimport {ApiService} from \"db://assets/slotBar/scripts/services/ApiService\";\r\nimport EventBus from \"db://assets/slotBar/scripts/eventSystem/EventCenter\";\r\nimport {loginViewEventTypes, tipTextEventTypes} from \"db://assets/slotBar/scripts/eventSystem/EventTypes\";\r\n\r\nconst {ccclass, property} = _decorator;\r\n\r\n@ccclass('RegisterView')\r\nexport class RegisterView extends Component {\r\n\r\n    @property(EditBox)\r\n    accountInput: EditBox = null;\r\n\r\n    @property(EditBox)\r\n    passwordInput: EditBox = null;\r\n\r\n    @property(EditBox)\r\n    emailInput: EditBox = null;\r\n\r\n    @property(Button)\r\n    backLoginButton: Button = null;\r\n\r\n    @property(Button)\r\n    registerButton: Button = null;\r\n\r\n    onEnable() {\r\n        this.backLoginButton.node.on('click', this.onLoginButtonClickSpin, this);\r\n        this.registerButton.node.on('click', this.onRegisterButtonClickSpin, this);\r\n    }\r\n\r\n    onDisable() {\r\n        this.backLoginButton.node.off('click', this.onLoginButtonClickSpin, this);\r\n        this.registerButton.node.off('click', this.onRegisterButtonClickSpin, this);\r\n    }\r\n\r\n    onLoginButtonClickSpin() {\r\n        EventBus.loginViewEventBus.emit(loginViewEventTypes.OpenLoginView);\r\n    }\r\n\r\n    async onRegisterButtonClickSpin() {\r\n        const username = this.accountInput.string.trim();\r\n        const password = this.passwordInput.string.trim();\r\n        const email = this.emailInput.string.trim();\r\n\r\n        if (!username || !password) {\r\n            console.log(\"請輸入帳號或密碼\");\r\n            EventBus.tipTextEventBus.emit(tipTextEventTypes.ShowTipText, {text: '請輸入帳號或密碼'});\r\n            return;\r\n        }\r\n\r\n        if (!email) {\r\n            EventBus.tipTextEventBus.emit(tipTextEventTypes.ShowTipText, {text: '請輸入電子信箱'});\r\n            console.warn(\"請輸入電子信箱\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const result = await ApiService.register(username, password, email);\r\n\r\n            if (result.success) {\r\n                console.log(\"✅ 註冊成功！\");\r\n                EventBus.tipTextEventBus.emit(tipTextEventTypes.ShowTipText, {text: '✅ 註冊成功！請到信箱收取信件'});\r\n                EventBus.loginViewEventBus.emit(loginViewEventTypes.OpenLoginView);\r\n            } else {\r\n                console.warn(\"❌ 註冊失敗：\", result.message);\r\n                EventBus.tipTextEventBus.emit(tipTextEventTypes.ShowTipText, {text: result.message || '❌ 註冊失敗，請稍後再試'});\r\n            }\r\n        } catch (err) {\r\n            console.error(\"❌ 登入失敗：\", err);\r\n            EventBus.tipTextEventBus.emit(tipTextEventTypes.ShowTipText, {text: '❌ 註冊失敗，請稍後再試'});\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}